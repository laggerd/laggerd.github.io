<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0" /> -->
    <link href="styles/style.css" rel="stylesheet" type="text/css">
    <title>Web Player</title>

    
</head>

<body>
    <h1>MandelMaker</h1>
    <canvas id="canvas" height="600px" width="1000px"></canvas>


    <div style="text-align: right; margin-right: 2%;"><p style="display: inline-block;">Iteration Equation: </p><input type="text" id="textbox" size="70" style="display: inline-block;" value = "z = p(z, 2) + c"></div>
    <div style="text-align: right; margin-right: 2%;"><p style="display: inline-block;">Coloring Exponent (set to the polynomial degree): </p><input type="number" id="coloring" size="70" style="display: inline-block;" value = "2"></div>
    <div style="text-align: right; margin-right: 2%;"><p style="display: inline-block;">Number of Iterations: </p><input type="number" id="iterations" size="70" style="display: inline-block;" value = "50"></div>
    <div style="text-align: right; margin-right: 2%; margin-bottom: 1.5%;"><button type="button" id="mybutton">Reload Shader</button></div>

    <hr>

    <h3>Explore the Fractals of Iterated Functions</h3>
    <p>
        Controls are <u>arrow keys to pan</u> and <u>W/S to zoom</u>, <u>A/D to rotate</u>, and <u>H for fullscreen</u>. <br>Not particularly well optimized, and resolution is limited by 32 bit floats, but have fun!
    </p>

    <h3>Function Writing Guide</h3>
    <p>
        Write a valid <a href="https://www.w3.org/TR/WGSL/">WGSL</a> snippet that iterates z.<br>Here are some functions which you can use:
        <ul>
            <li>m(a, b) .. multiply two complex numbers</li>
            <li>p(a, [int]) .. raise a complex number to an integer power</li>
            <li>d(a, b) .. divide a by b, both being a complex number</li>
            <li>c .. parameter which depends on screen position</li>
            <li>t .. time</li>
            <li>vec2&ltf32>(r, i) .. declare a complex number with real component r, imaginary component i</li>
            <li>abs(a) and many other WGSL functions are available</li>
        </ul>
    </p>

    <h3>My Favorite Functions</h3>
    <p>
        <ul>
            <li>Mandelbrot Set: z = p(z, 2) + c</li>
            <li>Twisted Details: z = d(p(z, 4), abs(p(z, 2))+vec2&ltf32>(1.0, 0.0)) + c</li>
            <li>Butterfly Nexus: z = d(p(z, 3), z + vec2&ltf32>(0.01, 0.01)) + c</li>
        </ul>
    </p>

    <hr>
    <img src="mandel.jpg" alt="mandelbrot section">
    <img src="twist.jpg" alt="twisted details section">
    <img src="butterfly.jpg" alt="butterfly nexus section">

    <script type="module">
        var canvas = document.getElementById("canvas");
        canvas.oncontextmenu = function(e) { e.preventDefault(); e.stopPropagation(); }
        import init, {say_hi, repeat_me} from "./hello_window.js";
        
        var button = document.getElementById("mybutton");
        button.addEventListener('click', function(){
            //console.error("a");
            var phrase = document.getElementById("textbox").value;
            var coloring = String(document.getElementById("coloring").value);
            var iters = String(document.getElementById("iterations").value);
            //console.log("b");
            window.my_string = phrase;
            window.coloring_exponent = coloring;
            window.iterations = iters;
            //console.log("c");
            //say_hi();
            //console.log("d");
            //repeat_me(phrase);
            //console.log("e");
        });

        window.my_string = null;
        window.coloring_exponent = null;
        window.iterations = null;

        console.log(window.my_string);
        window.addEventListener("load", () => {
            init();
        });
    </script>
    
</body>

</html>